var Ae=Object.defineProperty,Pe=Object.defineProperties;var je=Object.getOwnPropertyDescriptors;var q=Object.getOwnPropertySymbols;var ee=Object.prototype.hasOwnProperty,te=Object.prototype.propertyIsEnumerable;var ne=(e,n,a)=>n in e?Ae(e,n,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[n]=a,V=(e,n)=>{for(var a in n||(n={}))ee.call(n,a)&&ne(e,a,n[a]);if(q)for(var a of q(n))te.call(n,a)&&ne(e,a,n[a]);return e},oe=(e,n)=>Pe(e,je(n));var se=(e,n)=>{var a={};for(var c in e)ee.call(e,c)&&n.indexOf(c)<0&&(a[c]=e[c]);if(e!=null&&q)for(var c of q(e))n.indexOf(c)<0&&te.call(e,c)&&(a[c]=e[c]);return a};import{a as Q,b as ae,_ as j,u as ce,c as N,d as Ne,L as Oe,e as Ke,f as Ue,g as re,l as le,h as ie}from"./index.34d84ec4.js";import{F as Ve}from"./index.8ac2b939.js";import{aS as ue,d as F,aJ as B,A as i,aC as $,aF as t,aG as s,E as d,aL as I,aM as M,C as X,B as D,aH as H,D as W,aD as R,bt as qe,aI as J,bs as He,bf as de,bu as We,b6 as _e,bo as Je,bv as Ge,bw as Qe,b5 as Xe,bx as Ye,e as z,r as Ze,t as et,c as S,u as y,bb as tt,by as nt,aT as pe,bz as ot,bk as st,i as at,b8 as fe,b9 as ve,bc as ct,bA as rt,bB as lt,bC as it,bD as ut,bE as dt,bF as _t,bG as pt,h as ge,bH as he,bI as ft,bJ as vt,w as ye,bK as gt,bL as ht,o as yt,bM as bt,bN as mt,bq as be,bO as kt,bP as $t,p as Ct,bQ as wt,bR as xt,bS as Lt,aV as St,bT as Mt,bU as Tt}from"./arco.5a21ddbb.js";import{f as G,h as Bt,i as It,j as Dt,k as me,l as Rt}from"./vue.39888ce3.js";/* empty css              */import{u as Et}from"./index.a97e0f32.js";/* empty css               */import"./chart.c92cdaf9.js";function Ft(){const e=G(),n=Q();return{logout:async c=>{await n.logout();const p=e.currentRoute.value;ue.success("\u767B\u51FA\u6210\u529F"),e.push({name:c&&typeof c=="string"?c:"login",query:oe(V({},e.currentRoute.value.query),{redirect:p.name})})}}}function zt(){return ae.post("/api/message/list")}function At(e){return ae.post("/api/message/read",e)}const Pt=I("\u672A\u5F00\u59CB"),jt=I("\u5DF2\u5F00\u901A"),Nt=I("\u8FDB\u884C\u4E2D"),Ot=I("\u5373\u5C06\u5230\u671F"),Kt=["onClick"],Ut=["src"],Vt={class:"footer-wrap"},qt={class:"footer-wrap"},Ht=F({props:{renderList:{type:Array,required:!0},unreadCount:{type:Number,default:0}},emits:["itemClick"],setup(e,{emit:n}){const a=e,c=()=>{n("itemClick",[...a.renderList])},p=v=>{v.status||n("itemClick",[v])},u=3;return(v,h)=>{const w=He,r=B("icon-desktop"),C=de,x=We,l=_e,f=Je,m=Ge,o=Qe,_=Xe,k=Ye;return i(),$(k,{bordered:!1},{footer:t(()=>[s(l,{fill:"",size:0,class:X({"add-border-top":e.renderList.length<u})},{default:t(()=>[d("div",Vt,[s(_,{onClick:c},{default:t(()=>[I(M(v.$t("messageBox.allRead")),1)]),_:1})]),d("div",qt,[s(_,null,{default:t(()=>[I(M(v.$t("messageBox.viewMore")),1)]),_:1})])]),_:1},8,["class"])]),default:t(()=>[(i(!0),D(J,null,H(e.renderList,g=>(i(),$(o,{key:g.id,"action-layout":"vertical",style:W({opacity:g.status?.5:1})},{extra:t(()=>[g.messageType===0?(i(),$(w,{key:0,color:"gray"},{default:t(()=>[Pt]),_:1})):g.messageType===1?(i(),$(w,{key:1,color:"green"},{default:t(()=>[jt]),_:1})):g.messageType===2?(i(),$(w,{key:2,color:"blue"},{default:t(()=>[Nt]),_:1})):g.messageType===3?(i(),$(w,{key:3,color:"red"},{default:t(()=>[Ot]),_:1})):R("",!0)]),default:t(()=>[d("div",{class:"item-wrap",onClick:L=>p(g)},[s(m,null,qe({title:t(()=>[s(l,{size:4},{default:t(()=>[d("span",null,M(g.title),1),s(x,{type:"secondary"},{default:t(()=>[I(M(g.subTitle),1)]),_:2},1024)]),_:2},1024)]),description:t(()=>[d("div",null,[s(f,{ellipsis:{rows:1}},{default:t(()=>[I(M(g.content),1)]),_:2},1024),g.type==="message"?(i(),$(x,{key:0,class:"time-text"},{default:t(()=>[I(M(g.time),1)]),_:2},1024)):R("",!0)])]),_:2},[g.avatar?{name:"avatar",fn:t(()=>[s(C,{shape:"circle"},{default:t(()=>[g.avatar?(i(),D("img",{key:0,src:g.avatar},null,8,Ut)):(i(),$(r,{key:1}))]),_:2},1024)])}:void 0]),1024)],8,Kt)]),_:2},1032,["style"]))),128)),e.renderList.length&&e.renderList.length<3?(i(),D("div",{key:0,style:W({height:(u-e.renderList.length)*86+"px"})},null,4)):R("",!0)]),_:1})}}});var Wt=j(Ht,[["__scopeId","data-v-da998396"]]);const Jt=F({setup(e){const{loading:n,setLoading:a}=Et(!0),c=z("message"),{t:p}=ce(),u=Ze({renderList:[],messageList:[]});et(u);const v=[{key:"message",title:p("messageBox.tab.title.message")},{key:"notice",title:p("messageBox.tab.title.notice")},{key:"todo",title:p("messageBox.tab.title.todo")}];async function h(){a(!0);try{const{data:o}=await zt();u.messageList=o}catch{}finally{a(!1)}}async function w(o){const _=o.map(k=>k.id);await At({ids:_}),h()}const r=S(()=>u.messageList.filter(o=>c.value===o.type)),C=S(()=>r.value.filter(o=>!o.status).length),x=o=>u.messageList.filter(k=>k.type===o&&!k.status),l=o=>{const _=x(o);return _.length?`(${_.length})`:""},f=o=>{r.value.length&&w([...o])},m=()=>{u.messageList=[]};return h(),(o,_)=>{const k=tt,g=nt,L=pe,E=ot,b=st;return i(),$(b,{style:{display:"block"},loading:y(n)},{default:t(()=>[s(E,{activeKey:c.value,"onUpdate:activeKey":_[0]||(_[0]=T=>c.value=T),type:"rounded","destroy-on-hide":""},{extra:t(()=>[s(L,{type:"text",onClick:m},{default:t(()=>[I(M(o.$t("messageBox.tab.button")),1)]),_:1})]),default:t(()=>[(i(),D(J,null,H(v,T=>s(g,{key:T.key},{title:t(()=>[d("span",null,M(T.title)+M(l(T.key)),1)]),default:t(()=>[y(r).length?R("",!0):(i(),$(k,{key:0,status:"404"},{subtitle:t(()=>[I(M(o.$t("messageBox.noContent")),1)]),_:1})),s(Wt,{"render-list":y(r),"unread-count":y(C),onItemClick:f},null,8,["render-list","unread-count"])]),_:2},1024)),64))]),_:1},8,["activeKey"])]),_:1},8,["loading"])}}});var Gt=j(Jt,[["__scopeId","data-v-cfab683a"]]);const Qt=e=>(fe("data-v-f52cc24a"),e=e(),ve(),e),Xt={class:"navbar"},Yt={class:"left-side"},Zt=Qt(()=>d("img",{alt:"logo",src:"//p3-armor.byteimg.com/tos-cn-i-49unhts6dw/dfdba5317c0c20ce20e64fac803d52bc.svg~tplv-49unhts6dw-image.image"},null,-1)),en=I(" Arco Pro "),tn={class:"right-side"},nn={class:"message-box-trigger"},on=["src"],sn=F({setup(e){const n=N(),a=Q(),{logout:c}=Ft(),{changeLocale:p}=Ne(),{isFullscreen:u,toggle:v}=Bt(),h=[...Oe],w=S(()=>a.avatar),r=S(()=>n.theme),C=It({selector:"body",attribute:"arco-theme",valueDark:"dark",valueLight:"light",storageKey:"arco-theme",onChanged(b){n.toggleTheme(b)}}),x=Dt(C),l=()=>{x()},f=()=>{n.updateSettings({globalSettings:!0})},m=z(),o=z(),_=()=>{const b=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});m.value.dispatchEvent(b)},k=()=>{c()},g=()=>{const b=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});o.value.dispatchEvent(b)},L=async()=>{const b=await a.switchRoles();ue.success(b)},E=at("toggleDrawerMenu");return(b,T)=>{const $e=ct,Ce=B("icon-menu-fold"),O=_e,we=B("icon-search"),A=pe,P=rt,xe=B("icon-language"),K=lt,Y=it,Le=B("icon-moon-fill"),Se=B("icon-sun-fill"),Me=B("icon-notification"),Te=ut,Be=dt,Ie=B("icon-fullscreen-exit"),De=B("icon-fullscreen"),Z=B("icon-settings"),Re=de,Ee=B("icon-tag"),Fe=B("icon-user"),ze=B("icon-export");return i(),D("div",Xt,[d("div",Yt,[s(O,null,{default:t(()=>[Zt,s($e,{style:{margin:0,fontSize:"18px"},heading:5},{default:t(()=>[en]),_:1}),y(n).device==="mobile"?(i(),$(Ce,{key:0,style:{"font-size":"22px",cursor:"pointer"},onClick:y(E)},null,8,["onClick"])):R("",!0)]),_:1})]),d("ul",tn,[d("li",null,[s(P,{content:b.$t("settings.search")},{default:t(()=>[s(A,{class:"nav-btn",type:"outline",shape:"circle"},{icon:t(()=>[s(we)]),_:1})]),_:1},8,["content"])]),d("li",null,[s(P,{content:b.$t("settings.language")},{default:t(()=>[s(A,{class:"nav-btn",type:"outline",shape:"circle",onClick:g},{icon:t(()=>[s(xe)]),_:1})]),_:1},8,["content"]),s(Y,{trigger:"click",onSelect:y(p)},{content:t(()=>[(i(),D(J,null,H(h,U=>s(K,{key:U.value,value:U.value},{default:t(()=>[I(M(U.label),1)]),_:2},1032,["value"])),64))]),default:t(()=>[d("div",{ref_key:"triggerBtn",ref:o,class:"trigger-btn"},null,512)]),_:1},8,["onSelect"])]),d("li",null,[s(P,{content:y(r)==="light"?b.$t("settings.navbar.theme.toDark"):b.$t("settings.navbar.theme.toLight")},{default:t(()=>[s(A,{class:"nav-btn",type:"outline",shape:"circle",onClick:l},{icon:t(()=>[y(r)==="dark"?(i(),$(Le,{key:0})):(i(),$(Se,{key:1}))]),_:1})]),_:1},8,["content"])]),d("li",null,[s(P,{content:b.$t("settings.navbar.alerts")},{default:t(()=>[d("div",nn,[s(Te,{count:9,dot:""},{default:t(()=>[s(A,{class:"nav-btn",type:"outline",shape:"circle",onClick:_},{default:t(()=>[s(Me)]),_:1})]),_:1})])]),_:1},8,["content"]),s(Be,{trigger:"click","arrow-style":{display:"none"},"content-style":{padding:0,minWidth:"400px"},"content-class":"message-popover"},{content:t(()=>[s(Gt)]),default:t(()=>[d("div",{ref_key:"refBtn",ref:m,class:"ref-btn"},null,512)]),_:1})]),d("li",null,[s(P,{content:y(u)?b.$t("settings.navbar.screen.toExit"):b.$t("settings.navbar.screen.toFull")},{default:t(()=>[s(A,{class:"nav-btn",type:"outline",shape:"circle",onClick:y(v)},{icon:t(()=>[y(u)?(i(),$(Ie,{key:0})):(i(),$(De,{key:1}))]),_:1},8,["onClick"])]),_:1},8,["content"])]),d("li",null,[s(P,{content:b.$t("settings.title")},{default:t(()=>[s(A,{class:"nav-btn",type:"outline",shape:"circle",onClick:f},{icon:t(()=>[s(Z)]),_:1})]),_:1},8,["content"])]),d("li",null,[s(Y,{trigger:"click"},{content:t(()=>[s(K,null,{default:t(()=>[s(O,{onClick:L},{default:t(()=>[s(Ee),d("span",null,M(b.$t("messageBox.switchRoles")),1)]),_:1})]),_:1}),s(K,null,{default:t(()=>[s(O,{onClick:T[0]||(T[0]=U=>b.$router.push({name:"Info"}))},{default:t(()=>[s(Fe),d("span",null,M(b.$t("messageBox.userCenter")),1)]),_:1})]),_:1}),s(K,null,{default:t(()=>[s(O,{onClick:T[1]||(T[1]=U=>b.$router.push({name:"Setting"}))},{default:t(()=>[s(Z),d("span",null,M(b.$t("messageBox.userSettings")),1)]),_:1})]),_:1}),s(K,null,{default:t(()=>[s(O,{onClick:k},{default:t(()=>[s(ze),d("span",null,M(b.$t("messageBox.logout")),1)]),_:1})]),_:1})]),default:t(()=>[s(Re,{size:32,style:{marginRight:"8px",cursor:"pointer"}},{default:t(()=>[d("img",{alt:"avatar",src:y(w)},null,8,on)]),_:1})]),_:1})])])])}}});var an=j(sn,[["__scopeId","data-v-f52cc24a"]]);const cn=(e,n)=>{const p=n||{},{target:a="_blank"}=p,c=se(p,["target"]);window.open(e,a,Object.entries(c).reduce((u,v)=>{const[h,w]=v;return[...u,`${h}=${w}`]},[]).join(","))},rn=new RegExp("^(?!mailto:)(?:(?:http|https|ftp)://)(?:\\S+(?::\\S*)?@)?(?:(?:(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[0-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]+-?)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]+-?)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,})))|localhost)(?::\\d{2,5})?(?:(/|\\?|#)[^\\s]*)?$","i"),ln=[...Ke,...Ue],un=ln.map(e=>{const{name:n,path:a,meta:c,redirect:p,children:u}=e;return{name:n,path:a,meta:c,redirect:p,children:u}});function dn(){const e=re(),n=N(),a=S(()=>n.menuFromServer?n.appAsyncMenus:un);return{menuTree:S(()=>{const p=JSON.parse(JSON.stringify(a.value));p.sort((v,h)=>(v.meta.order||0)-(h.meta.order||0));function u(v,h){return v?v.map(r=>{var x,l;if(!e.accessRouter(r))return null;if(((x=r.meta)==null?void 0:x.hideChildrenInMenu)||!r.children)return r.children=[],r;r.children=r.children.filter(f=>{var m;return((m=f.meta)==null?void 0:m.hideInMenu)!==!0});const C=u(r.children,h+1);return C.length||h>1?(r.children=C,r):((l=r.meta)==null?void 0:l.hideInMenu)===!1?r:null}).filter(Boolean):null}return u(p,0)})}}function _n(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!_t(e)}var pn=F({emit:["collapse"],setup(){const{t:e}=ce(),n=N(),a=G(),c=me(),{menuTree:p}=dn(),u=S({get(){return n.device==="desktop"?n.menuCollapse:!1},set(l){n.updateSettings({menuCollapse:l})}}),v=z([]),h=z([]),w=l=>{if(rn.test(l.path)){cn(l.path),h.value=[l.name];return}const{hideInMenu:f,activeMenu:m}=l.meta;if(c.name===l.name&&!f&&!m){h.value=[l.name];return}a.push({name:l.name})},r=l=>{const f=[];let m=!1;const o=(_,k,g)=>{var L;if(_.name===g){m=!0,f.push(...k,_.name);return}((L=_.children)==null?void 0:L.length)&&_.children.forEach(E=>{o(E,[...k],g)})};return p.value.forEach(_=>{m||o(_,[_.name],l)}),f};le(l=>{const{requiresAuth:f,activeMenu:m,hideInMenu:o}=l.meta;if(f&&(!o||m)){const _=r(m||l.name),k=new Set([..._,...v.value]);v.value=[...k],h.value=[m||_[_.length-1]]}},!0);const C=l=>{n.device==="desktop"&&n.updateSettings({menuCollapse:l})},x=()=>{function l(f,m=[]){return f&&f.forEach(o=>{var g;const _=((g=o==null?void 0:o.meta)==null?void 0:g.icon)?()=>{var L;return ge(he(`<${(L=o==null?void 0:o.meta)==null?void 0:L.icon}/>`))}:null,k=(o==null?void 0:o.children)&&(o==null?void 0:o.children.length)!==0?s(ft,{key:o==null?void 0:o.name},{default:()=>[l(o==null?void 0:o.children)],icon:_,title:()=>{var L;return ge(he(e(((L=o==null?void 0:o.meta)==null?void 0:L.locale)||"")))}}):s(vt,{key:o==null?void 0:o.name,onClick:()=>w(o)},{default:()=>{var L;return[e(((L=o==null?void 0:o.meta)==null?void 0:L.locale)||"")]},icon:_});m.push(k)}),m}return l(p.value)};return()=>{let l;return s(pt,{collapsed:u.value,"onUpdate:collapsed":f=>u.value=f,"open-keys":v.value,"onUpdate:open-keys":f=>v.value=f,"show-collapse-button":n.device!=="mobile","auto-open":!1,"selected-keys":h.value,"auto-open-selected":!0,"level-indent":34,style:"height: 100%",onCollapse:C},_n(l=x())?l:{default:()=>[l]})}}});var ke=j(pn,[["__scopeId","data-v-7532b26c"]]);const fn=e=>(fe("data-v-23971f0e"),e=e(),ve(),e),vn={class:"tab-bar-container"},gn={class:"tab-bar-box"},hn={class:"tab-bar-scroll"},yn={class:"tags-wrap"},bn=["onClick"],mn={class:"tag-link"},kn=["onClick"],$n=fn(()=>d("div",{class:"tag-bar-operation"},null,-1)),Cn=F({setup(e){const n=N(),a=ie(),c=G(),p=z(),u=S(()=>a.getTabList),v=S(()=>n.navbar?60:0);ye(()=>n.navbar,()=>{p.value.updatePosition()}),le(r=>{!r.meta.noAffix&&!u.value.some(C=>C.fullPath===r.fullPath)&&a.updateTabList(r)},!0);const h=(r,C)=>{if(a.deleteTag(C,r),C===u.value.length){const x=u.value[u.value.length-1];c.push({name:x.name})}},w=r=>{c.push(V({},r))};return(r,C)=>{const x=B("icon-close"),l=ht;return i(),D("div",vn,[s(l,{ref_key:"affixRef",ref:p,"offset-top":y(v)},{default:t(()=>[d("div",gn,[d("div",hn,[d("div",yn,[(i(!0),D(J,null,H(y(u),(f,m)=>(i(),D("span",{key:f.fullPath,class:X(["arco-tag arco-tag-size-medium arco-tag-checked",{"link-activated":f.fullPath===r.$route.fullPath}]),onClick:o=>w(f)},[d("span",mn,M(r.$t(f.title)),1),d("span",{class:"arco-icon-hover arco-tag-icon-hover arco-icon-hover-size-medium arco-tag-close-btn",onClick:gt(o=>h(f,m),["stop"])},[s(x)],8,kn)],10,bn))),128))])]),$n])]),_:1},8,["offset-top"])])}}});var wn=j(Cn,[["__scopeId","data-v-23971f0e"]]);function xn(e,n,a,c=!1){e.addEventListener&&typeof e.addEventListener=="function"&&e.addEventListener(n,a,c)}function Ln(e,n,a,c=!1){e.removeEventListener&&typeof e.removeEventListener=="function"&&e.removeEventListener(n,a,c)}const Sn=992;function Mn(){return document.body.getBoundingClientRect().width-1<Sn}function Tn(e){const n=N();function a(){if(!document.hidden){const p=Mn();n.toggleDevice(p?"mobile":"desktop"),n.toggleMenu(p)}}const c=Rt(a,100);yt(()=>{e&&c()}),bt(()=>{xn(window,"resize",c)}),mt(()=>{Ln(window,"resize",c)})}const Bn=F({setup(e){const n=ie(),a=S(()=>n.getCacheList);return(c,p)=>{const u=B("router-view");return i(),$(u,null,{default:t(({Component:v,route:h})=>[s($t,{name:"fade",mode:"out-in",appear:""},{default:t(()=>[h.meta.ignoreCache?(i(),$(be(v),{key:h.fullPath})):(i(),$(kt,{key:1,include:y(a)},[(i(),$(be(v),{key:h.fullPath}))],1032,["include"]))]),_:2},1024)]),_:1})}}});const In={key:0,class:"layout-navbar"},Dn={class:"menu-wrapper"},Rn=F({setup(e){const n=N(),a=Q(),c=G(),p=me(),u=re();Tn(!0);const v="60px",h=S(()=>n.navbar),w=S(()=>n.menu),r=S(()=>n.hideMenu),C=S(()=>n.footer),x=S(()=>n.menuCollapse?48:n.menuWidth),l=S(()=>n.menuCollapse),f=S(()=>{const k=w.value&&!r.value?{paddingLeft:`${x.value}px`}:{},g=h.value?{paddingTop:v}:{};return V(V({},k),g)}),m=k=>{n.updateSettings({menuCollapse:k})};ye(()=>a.role,k=>{k&&!u.accessRouter(p)&&c.push({name:"notFound"})});const o=z(!1),_=()=>{o.value=!1};return Ct("toggleDrawerMenu",()=>{o.value=!o.value}),(k,g)=>{const L=Lt,E=St,b=Mt,T=Tt;return i(),$(T,{class:X(["layout",{mobile:y(n).hideMenu}])},{default:t(()=>[y(h)?(i(),D("div",In,[s(an)])):R("",!0),s(T,null,{default:t(()=>[s(T,null,{default:t(()=>[y(w)?wt((i(),$(L,{key:0,class:"layout-sider",breakpoint:"xl",collapsed:y(l),collapsible:!0,width:y(x),style:W({paddingTop:y(h)?"60px":""}),"hide-trigger":!0,onCollapse:m},{default:t(()=>[d("div",Dn,[s(ke)])]),_:1},8,["collapsed","width","style"])),[[xt,!y(r)]]):R("",!0),y(r)?(i(),$(E,{key:1,visible:o.value,placement:"left",footer:!1,"mask-closable":"",closable:!1,onCancel:_},{default:t(()=>[s(ke)]),_:1},8,["visible"])):R("",!0),s(T,{class:"layout-content",style:W(y(f))},{default:t(()=>[y(n).tabBar?(i(),$(wn,{key:0})):R("",!0),s(b,null,{default:t(()=>[s(Bn)]),_:1}),y(C)?(i(),$(Ve,{key:1})):R("",!0)]),_:1},8,["style"])]),_:1})]),_:1})]),_:1},8,["class"])}}});var Un=j(Rn,[["__scopeId","data-v-5424861c"]]);export{Un as default};
